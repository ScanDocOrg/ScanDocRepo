package scandoc.Documents;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Combo;
import org.eclipse.swt.widgets.Dialog;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.FileDialog;
import org.eclipse.swt.widgets.Group;
import org.eclipse.swt.widgets.Label;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Text;
import org.eclipse.wb.swt.SWTResourceManager;

import scandoc.MainWindow;

import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.graphics.GC;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.graphics.Rectangle;

public class DiagDetailDocument extends Dialog {

	protected Object result;
	protected Shell shlDetailDocument;
	private Text txtIdDocument;
	private Text txtNomTitulaire;
	private Text txtPrenomTitulaire;
	private Display display;
	/**
	 * Create the dialog.
	 * @param parent
	 * @param style
	 */
	public DiagDetailDocument(Shell parent, int style) {
		super(parent, style);
		setText("Détails Document");
	}

	/**
	 * Open the dialog.
	 * @return the result
	 */
	public Object open() {
		createContents();
		shlDetailDocument.open();
		shlDetailDocument.layout();
		display = getParent().getDisplay();
		while (!shlDetailDocument.isDisposed()) {
			if (!display.readAndDispatch()) {
				display.sleep();
			}
		}
		return result;
	}

	/**
	 * Create contents of the dialog.
	 */
	private void createContents() {
		shlDetailDocument = new Shell(getParent(), getStyle());
		shlDetailDocument.setBackground(SWTResourceManager.getColor(SWT.COLOR_WIDGET_DARK_SHADOW));
		shlDetailDocument.setSize(800, 800);
		shlDetailDocument.setText("Detail Document");
		shlDetailDocument.setLayout(null);
		
		Group grpDocument = new Group(shlDetailDocument, SWT.BORDER | SWT.SHADOW_OUT);
		grpDocument.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		grpDocument.setText("Document");
		grpDocument.setBounds(10, 10, 774, 751);
		
		Label lblId = new Label(grpDocument, SWT.NONE);
		lblId.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		lblId.setBounds(10, 28, 20, 21);
	 	lblId.setText("Id :");
		
		txtIdDocument = new Text(grpDocument, SWT.BORDER);
		txtIdDocument.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		txtIdDocument.setBounds(36, 28, 287, 21);
		
		Label lblType = new Label(grpDocument, SWT.NONE);
		lblType.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		lblType.setBounds(340, 28, 39, 21);
		lblType.setText("Type :");
		
		txtNomTitulaire = new Text(grpDocument, SWT.BORDER);
		txtNomTitulaire.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		txtNomTitulaire.setBounds(444, 67, 302, 21);
		
		Label lblNomTitulaire = new Label(grpDocument, SWT.NONE);
		lblNomTitulaire.setText("Nom Titulaire :");
		lblNomTitulaire.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		lblNomTitulaire.setBounds(340, 67, 98, 21);
		
		Label lblPrenomTitulaire = new Label(grpDocument, SWT.NONE);
		lblPrenomTitulaire.setText("Prenom Titulaire :");
		lblPrenomTitulaire.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		lblPrenomTitulaire.setBounds(10, 67, 118, 21);
		
		txtPrenomTitulaire = new Text(grpDocument, SWT.BORDER);
		txtPrenomTitulaire.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		txtPrenomTitulaire.setBounds(134, 67, 189, 21);
		
		Button btnEffacer = new Button(grpDocument, SWT.NONE);
		btnEffacer.addSelectionListener(new SelectionAdapter() {
			@Override
			public void widgetSelected(SelectionEvent e) {
			}
		});
		btnEffacer.setText("Effacer");
		btnEffacer.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		btnEffacer.setBounds(34, 711, 153, 25);
		
		Button btnEditer = new Button(grpDocument, SWT.NONE);
		btnEditer.addSelectionListener(new SelectionAdapter() {
			@Override
			public void widgetSelected(SelectionEvent e) {
			}
		});
		btnEditer.setText("Editer");
		btnEditer.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		btnEditer.setBounds(221, 711, 153, 25);
		
		Button btnSave = new Button(grpDocument, SWT.NONE);
		btnSave.addSelectionListener(new SelectionAdapter() {
			@Override
			public void widgetSelected(SelectionEvent e) {
			}
		});
		btnSave.setText("Save");
		btnSave.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		btnSave.setBounds(408, 711, 153, 25);
		
		Button btnChangeDocument = new Button(grpDocument, SWT.NONE);
		btnChangeDocument.addSelectionListener(new SelectionAdapter() {
			@Override
			public void widgetSelected(SelectionEvent e) {
			}
		});
		btnChangeDocument.setText("Change Document");
		btnChangeDocument.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		btnChangeDocument.setBounds(595, 711, 142, 25);
		
		Combo combo = new Combo(grpDocument, SWT.NONE);
		combo.setFont(SWTResourceManager.getFont("Segoe UI", 11, SWT.NORMAL));
		combo.setBounds(385, 25, 361, 28);
		
		//ScrolledComposite scrCompImage = new ScrolledComposite(grpDocument, SWT.BORDER | SWT.H_SCROLL | SWT.V_SCROLL);
		ScrolledComposite scrCompImage = new ScrolledComposite(grpDocument, SWT.H_SCROLL | SWT.V_SCROLL);
		scrCompImage.setAlwaysShowScrollBars(true);
		scrCompImage.setBounds(10, 94, 754, 611);
		//scrCompImage.setBounds(10, 94, 900,700);
		scrCompImage.setExpandHorizontal(true);
		scrCompImage.setExpandVertical(false);
		
		
		String originUrl = openFile();
		//Image image = new Image(display, "V:/Code/test/test-folder-2/files/ScreenShot1.jpg");
		Image image = new Image(display, originUrl);
		//Rectangle rect = image.getBounds ();
		//GC gc = new GC (image);
		//gc.fillRectangle (image.getBounds ());
		//gc.dispose ();
		
		
		//int width = rect.width/2;
		//int height = rect.height/2;
		
		//int position_x = 10; 
		//int position_y = 94;
		
		//gc.drawImage (image, 0, 0, width, height, position_x, position_y, width, height);
		
		//Label lblImage = new Label(scrCompImage, SWT.BORDER);
		//lblImage.setImage(image);
		
		Rectangle clientArea = scrCompImage.getClientArea ();
		scrCompImage.addListener (SWT.Paint, e -> {
			Rectangle rect = image.getBounds ();
			GC gc = e.gc;
			
			int width = rect.width/2;
			int height = rect.height/2;
			
			int position_x = 10; 
			int position_y = 94;
			
			gc.drawImage (image, 0, 0, width, height, position_x, position_y, width, height);
			//gc.drawImage (image, 0, 0, width, height, x+width, y, (int)Math.round(width * 0.5), (int)Math.round(height * 0.5));
			//gc.drawImage (image, 0, 0, width, height, x+width+(int)Math.round(width * 0.5), y, width * 2, height * 2);
		});
		//lblImage.setBounds(clientArea.x, clientArea.y, 100, 100);
		//lblImage.setLocation (clientArea.x, clientArea.y);
		//lblImage.pack();
		//scrCompImage.pack();
		//scrCompImage.setMinSize(lblImage.computeSize(SWT.DEFAULT, SWT.DEFAULT));
		//scrCompImage.setContent(lblImage);
		
		shlDetailDocument.open();
		
		//Image image = new Image(MainWindow.display, "V:\\Code\\test\\test-folder-2\\files\\s.png");
		//lblImage.setImage(SWTResourceManager.getImage("Y:\\Screenshots\\ScreenShot6.jpg"));

	}
	
	private String openFile() {
//////////////////////////////
		Shell shellopen = new Shell();
		FileDialog dialog = new FileDialog (shellopen, SWT.SELECTED);
		dialog.setText("Choisissez un document (jpg, png, pdf)");
		String [] filterNames = new String [] {"Image Files", "PDF Files"};
		String [] filterExtensions = new String [] {"*.jpg","*.png","*.pdf"};
		String filterPath = "/";
		String platform = SWT.getPlatform();
		
		if (platform.equals("win32")) {
		filterNames = new String [] {"JPG Files (*.jpg)","PNG Files (*.png)", "PDF Files (*.pdf)"};
		filterExtensions = new String [] {"*.jpg","*.png","*.pdf"};
		filterPath = "c:\\";
		}
		
		dialog.setFilterNames (filterNames);
		dialog.setFilterExtensions (filterExtensions);
		dialog.setFilterPath (filterPath);
		dialog.setFileName ("myfile");
		String originUrl = dialog.open ();
		return originUrl;
		//////////////////////////////////
	}
	
}
